# **§ 45 正则变换**

广义坐标 $q$ 的选择不受任何条件的限制，它们可以是任意单值确定系统在空间中位置的 $s$ 个量。
拉格朗日方程 (2.6) 的形式不依赖于这种选择，在这个意义下，可以说拉格朗日方程对于从广义坐标 $q_{1}, q_{2}, \dots$ 到任何另外的独立变量 $Q_{1}, Q_{2}, \dots$ 的变换具有不变性。
新坐标 $Q$ 是老坐标 $q$ 的函数，并且可以假定它们显含时间，即有形式为

$$
Q_{i} = Q_{i}(\,q , t\,)
$$

的变换（有时称为**点变换**）。

由于拉格朗日方程在变换 (45.1) 下不变，所以哈密顿方程 (40.4) 也保持不变。
然而，哈密顿方程实际上允许更广范围的变换。这是因为在哈密顿方法中动量 $p$ 与坐标 $q$ 都是平等的独立变量。
所以，变换可以推广到包括从 $2s$ 个独立变量 $(p, q)$ 到新变量 $(P, Q)$ 的变换，即

$$
Q_{i} = Q_{i}(p, q, t), \quad P_{i} = P_{i}(p, q, t) .
$$

对这种可能变换的类型的扩大，是力学的哈密顿方法的重要优点之一。

然而，并不是在形如 (45.2) 的所有变换下，运动方程均保持它们的正则形式。
下面我们研究变换满足什么条件，才可以使变量 $P, Q$ 表示的运动方程具有如下形式：

$$
\dot{Q}_{i} = \frac{\partial H'}{\partial P_{i}}, \quad \dot{P}_{i} = -\frac{\partial H'}{\partial Q_{i}},
$$

其中 $H'(P, Q)$ 是某个哈密顿函数。
在这些变换中有一类特别重要的变换，称之为**正则变换**。

---

可用如下步骤得到正则变换的公式。
在 §43 结尾处已经证明，哈密顿方程可以由下面形式的最小作用量原理推出：

$$
\delta \int \left( \sum_{i} p_{i}\,\mathrm{d}q_{i} - H\,\mathrm{d}t \right) = 0
$$

其中对所有坐标和动量独立地进行变分。
如果新变量 $P$ 和 $Q$ 也满足哈密顿方程，则下面的最小作用量原理也必须成立：

$$
\delta \int \left( \sum_{i} P_{i}\,\mathrm{d}Q_{i} - H'\,\mathrm{d}t \right) = 0 .
$$

如果 (45.4) 和 (45.5) 的被积函数仅相差关于坐标、动量和时间的某个函数 $F$ 的全微分，则两种形式当然是等价的，这时两个积分之差为在变分时不起作用的常数（即 $F$ 在两个积分限的值之差）。
因此，我们取关系：

$$
\sum_{i} p_{i}\,\mathrm{d}q_{i} - H\,\mathrm{d}t
= \sum_{i} P_{i}\,\mathrm{d}Q_{i} - H'\,\mathrm{d}t + \mathrm{d}F .
$$

满足这个条件的变换称为**正则变换**。每一个正则变换均由称为**母函数**的特定函数 $F$ 来表征。

---

将所得关系式写成

$$
\mathrm{d}F = \sum_{i} p_{i} \,\mathrm{d}q_{i} - \sum_{i} P_{i} \,\mathrm{d}Q_{i} + (H' - H)\,\mathrm{d}t ,
$$

可以看出：

$$
p_{i} = \frac{\partial F}{\partial q_{i}}, \quad
P_{i} = -\frac{\partial F}{\partial Q_{i}}, \quad
H' = H + \frac{\partial F}{\partial t},
$$

这里假设母函数是新、老坐标（和时间）的给定函数 $F = F(q, Q, t)$。
当函数 $F$ 已知时，公式 (45.7) 给出了老变量 $(p, q)$ 和新变量 $(P, Q)$ 的关系，同时还给出新的哈密顿函数。

---

不用变量 $q, Q$ 表示母函数，而是用老坐标 $q$ 和新动量 $P$ 表示母函数，可能会更方便。
为此，需要在关系式 (45.6) 中进行合适的勒让德变换，将其重写为：

$$
\mathrm{d}\left( F + \sum_{i} P_{i} Q_{i} \right)
= \sum_{i} p_{i} \,\mathrm{d}q_{i} + \sum_{i} Q_{i} \,\mathrm{d}P_{i} + (H' - H)\,\mathrm{d}t .
$$

等式左端括号内的表达式是用变量 $q, P$ 表示的，是新的母函数。
用 $\Phi(q, P, t)$ 表示这个母函数，于是有：

$$
p_{i} = \frac{\partial \Phi}{\partial q_{i}}, \quad
Q_{i} = \frac{\partial \Phi}{\partial P_{i}}, \quad
H' = H + \frac{\partial \Phi}{\partial t}.
$$

类似地，可以得到由依赖于变量 $(p, Q)$ 或者 $(p, P)$ 的母函数生成的正则变换公式。

---

应该指出，新老哈密顿函数之间的关系总具有相同的形式，即母函数对时间的偏导数给出它们的差 $H' - H$。
特别地，如果母函数不显含时间，则 $H' = H$，即为得到新的哈密顿函数，只需要将用新变量 $P, Q$ 表示的 $(p, q)$ 替换 $H$ 中的 $(p, q)$。

---

正则变换的广泛性，在很大程度上使哈密顿方法中广义坐标和广义动量的概念丧失其原始含义。
由于变换 (45.2) 将变量 $P, Q$ 中每一个都同坐标 $q$ 和动量 $p$ 联系在一起，所以变量 $Q$ 不再是纯粹的空间坐标。
$Q$ 和 $P$ 两者之间的区别本质上仅在于名称的不同。
这是很明显的，例如，变换 $Q_{i} = p_{i},\; P_{i} = -q_{i}$ 并不影响方程的正则形式，只是简单地将坐标和动量互换。

考虑到命名的任意性，变量 $p$ 和 $q$ 在哈密顿方法中经常被简称为**正则共轭变量**。

---

联系这些正则共轭变量的条件可以用泊松括号表示。
设 $\{ f, g \}_{p, q}$ 是 $f$ 和 $g$ 的泊松括号，其中微分运算是相对于变量 $(p, q)$ 的，
而 $\{ f, g \}_{P, Q}$ 是相对于变量 $(P, Q)$ 微分的泊松括号。于是有：

$$
\{ f, g \}_{p, q} = \{ f, g \}_{P, Q}.
$$

这个关系式的正确性可以利用正则变换公式直接计算得到，也可以通过下面的论证来证明。

---

首先，在正则变换 (45.7) 或者 (45.8) 中，时间以参数形式出现。
因此，如果我们证明定理 (45.9) 对于不显含时间的量成立，则对一般情况也成立。
现在我们纯粹在形式上将 $g$ 看作是某个假想系统的哈密顿函数，那么根据 (42.1)，有
$\{ f, g \}_{p, q} = - \mathrm{d}f / \mathrm{d}t$。
但是导数 $\mathrm{d}f / \mathrm{d}t$ 只依赖于假想系统的运动性质，而与变量的特定选择无关。
因此，在从一组正则变量变换到另一组正则变量时，泊松括号 $\{ f, g \}$ 不会改变。

由公式 (42.13) 和定理 (45.9) 可得：

$$
\{ Q_{i}, Q_{k} \}_{p, q} = 0, \quad
\{ P_{i}, P_{k} \}_{p, q} = 0, \quad
\{ P_{i}, Q_{k} \}_{p, q} = \delta_{ik}.
$$

这些是用泊松括号写出的，变换 $(p, q) \to (P, Q)$ 为正则变换时，新变量必须满足的条件。

---

值得指出的是，在运动中变量 $(p, q)$ 的变化本身也可以看作一系列的正则变换。
设 $q_{t}, p_{t}$ 是正则变量在 $t$ 时刻的值，而 $q_{t+\tau}, p_{t+\tau}$ 是在另一时刻 $t+\tau$ 的值，
后者是前者（以及作为参量的时间间隔 $\tau$）的某种函数：

$$
q_{t+\tau} = q(q_{t}, p_{t}, t, \tau), \quad
p_{t+\tau} = p(q_{t}, p_{t}, t, \tau) .
$$

如果将这些公式看作从变量 $(q_{t}, p_{t})$ 到变量 $(q_{t+\tau}, p_{t+\tau})$ 的变换，则它是正则变换。
从作用量

$$
\mathrm{d}S = \sum \left( p_{t+\tau}\,\mathrm{d}q_{t+\tau} - p_{t}\,\mathrm{d}q_{t} \right) - \left( H_{t+\tau} - H_{t} \right) \mathrm{d}t
$$

（见 (43.7)）可以看出这是显然的。
其中作用量 $S(q_{t+\tau}, q_{t}, t, \tau)$ 是沿着对给定 $\tau$ 在时间 $t$ 和 $t+\tau$ 经过点 $q_{t}$ 和 $q_{t+\tau}$ 的真实轨道所取的泛函。
比较这个公式和 (45.6) 可知，$-S$ 是变换的母函数。
