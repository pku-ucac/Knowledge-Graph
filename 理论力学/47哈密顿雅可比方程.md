# 哈密顿－雅可比方程

在 §43 中已经引入了作为坐标和时间的函数的作用量。
已经证明，这个函数 $S(\boldsymbol{q}, t)$ 对时间的偏导数与哈密顿函数的关系为

$$
\frac{\partial S}{\partial t} + H(q, p, t) = 0 ,
$$

而它对坐标的偏导数就是广义动量。
在哈密顿函数中将广义动量 $p$ 用导数 $\partial S / \partial q$ 代替，可得函数 $S(\boldsymbol{q}, t)$ 应该满足的方程：

$$
\frac{\partial S}{\partial t} + H\left(q_{1}, \cdots, q_{s} ;
\frac{\partial S}{\partial q_{1}}, \cdots, \frac{\partial S}{\partial q_{s}} ; t \right) = 0 .
$$

这是一阶偏微分方程，称为**哈密顿－雅可比方程**。

像拉格朗日方程和正则方程一样，哈密顿－雅可比方程也是积分求解运动方程的一般方法的基础。

---

在介绍这个方法之前，我们先说明一下，任何一阶偏微分方程都有依赖于任意函数的解，这个解称为方程的**通积分**。
然而，在力学应用中更重要的不是哈密顿－雅可比方程的通积分，而是**全积分**，它是偏微分方程的解，包含的独立任意常数的数目与独立变量的数目相等。

在哈密顿－雅可比方程中，独立变量是坐标和时间。
所以对于自由度为 $s$ 的系统，哈密顿－雅可比方程的全积分应该包括 $s+1$ 个任意常数。
又因为函数 $S$ 仅以其导数的形式出现在哈密顿－雅可比方程中，所以任意常数中有一个是以相加方式出现的，即哈密顿－雅可比方程的全积分形式为：

$$
S = f\left(t, q_{1}, \cdots, q_{s}; \alpha_{1}, \cdots, \alpha_{s}\right) + A ,
$$

其中 $\alpha_{1}, \cdots, \alpha_{s}$ 和 $A$ 是任意常数。

---

下面我们研究哈密顿－雅可比方程的全积分与运动方程解之间的关系。
为此我们进行从变量 $(q, p)$ 到新变量的正则变换，并且以 $f(t, q, \alpha)$ 为母函数，而 $\alpha_{1}, \alpha_{2}, \cdots, \alpha_{s}$ 作为新的动量。
新的坐标用 $\beta_{1}, \beta_{2}, \cdots, \beta_{s}$ 表示。
因为母函数依赖于老坐标和新动量，我们利用公式 (45.8)：

$$
p_{i} = \frac{\partial f}{\partial q_{i}}, \quad
\beta_{i} = \frac{\partial f}{\partial \alpha_{i}}, \quad
H' = H + \frac{\partial f}{\partial t} .
$$

由于函数 $f$ 满足哈密顿－雅可比方程，我们可以看出，新哈密顿函数应该等于零：

$$
H' = H + \frac{\partial f}{\partial t} = H + \frac{\partial S}{\partial t} = 0 .
$$

所以对新变量的正则方程为
$\dot{\alpha}_{i} = 0,\ \dot{\beta}_{i} = 0$，由此可得：

$$
\alpha_{i} = \mathrm{const}, \quad
\beta_{i} = \mathrm{const}.
$$

另一方面，利用 $s$ 个方程

$$
\frac{\partial f}{\partial \alpha_{i}} = \beta_{i}
$$

可以将 $s$ 个坐标 $q$ 用时间和 $2s$ 个常数 $(\alpha, \beta)$ 表示出来，这就给出了运动方程的通积分。

---

于是用哈密顿－雅可比方法求解力学系统的运动问题按如下步骤进行：

1. 根据哈密顿函数写出哈密顿－雅可比方程，并求该方程的全积分 (47.2)。
2. 将它对常数 $\alpha$ 求偏导数并使之等于新的常数 $\beta$，可得 $s$ 个代数方程：

   $$
   \frac{\partial S}{\partial \alpha_{i}} = \beta_{i}.
   $$
3. 求解这些代数方程得到 $q$ 作为时间和 $2s$ 个任意常数的函数。
4. 由方程 $p_{i} = \frac{\partial S}{\partial q_{i}}$ 可以求得动量对时间的依赖关系。

---

如果哈密顿－雅可比方程有**非全积分**，它依赖于少于 $s$ 个任意常数，则尽管不能由它求出运动方程的通积分，但是可以用来简化求通积分的过程。
例如，如果已知包含一个任意常数 $\alpha$ 的函数 $S$，则关系

$$
\frac{\partial S}{\partial \alpha} = \mathrm{const}
$$

给出一个关于 $q_{1}, \cdots, q_{s}$ 和 $t$ 的方程。

---

如果函数 $H$ 不显含时间，即系统是保守的，哈密顿－雅可比方程有更简单的形式。
这时作用量对时间的依赖关系归结为加上 $-Et$：

$$
S = S_{0}(q) - E t
$$

（参见 §44），代入 (47.1) 可得简约作用量 $S_{0}(q)$ 的如下形式的哈密顿－雅可比方程：

$$
H\left(q_{1}, \cdots, q_{s};
\frac{\partial S_{0}}{\partial q_{1}}, \cdots,
\frac{\partial S_{0}}{\partial q_{s}}\right) = E .
$$
